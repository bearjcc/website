# Railway Environment Variables

This document lists the required environment variables for Railway deployment.

## Critical Variables

### Database Configuration

Railway uses PostgreSQL. Set these variables in your Railway service:

```env
# Database Connection (use PostgreSQL in production)
DB_CONNECTION=pgsql

# Railway provides DATABASE_URL automatically when you add PostgreSQL plugin
# But you can also set individual variables:
DB_HOST=${Postgres.PGHOST}
DB_PORT=${Postgres.PGPORT}
DB_DATABASE=${Postgres.PGDATABASE}
DB_USERNAME=${Postgres.PGUSER}
DB_PASSWORD=${Postgres.PGPASSWORD}

# Session Configuration
# Important: Sessions must use PostgreSQL, not SQLite
SESSION_DRIVER=database
SESSION_CONNECTION=pgsql
```

### Application Configuration

```env
APP_ENV=production
APP_DEBUG=false
APP_KEY=<generated by Railway or set manually>
APP_URL=https://ursaminor.games

# Logging (Railway captures stderr/stdout)
LOG_CHANNEL=stderr
LOG_LEVEL=info
```

### Automatic Migrations & Seeding

```env
# Auto-run migrations on deploy
RUN_MIGRATIONS=1

# Optional: Auto-seed production data
# Note: Only use with idempotent seeders
# DB_SEED=1
```

## Initial Setup Steps

After deployment, if database is empty:

1. **Verify PostgreSQL Plugin** is connected
2. **Set** `RUN_MIGRATIONS=1` in environment variables
3. **Trigger redeploy** (push to main or manually redeploy)
4. **Seed production data**:
   ```bash
   # Via Railway CLI
   railway run php artisan db:seed --class=ProductionSeeder
   
   # Or via Railway shell
   # Open shell in Railway dashboard, then run:
   php artisan db:seed --class=ProductionSeeder
   ```

## How to Set Variables in Railway

1. Go to Railway dashboard
2. Select your "Ursa Minor Home" project
3. Click on your service
4. Go to "Variables" tab
5. Add/update the variables listed above

## Verifying PostgreSQL Plugin

Make sure you have the PostgreSQL plugin added to your Railway project:
1. Click "+ New" in Railway
2. Select "Database" â†’ "Add PostgreSQL"
3. Railway will automatically provide `${{Postgres.DATABASE_URL}}` and related variables

## After Setting Variables

Railway will automatically redeploy when you change environment variables. The deployment should succeed once PostgreSQL is properly configured.

